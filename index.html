<!doctype html>
<html lang="pl">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>FajneNotatki appka</title>
    <meta name="theme-color" content="#0d6efd">
    <link rel="manifest" href="manifest.json">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="bg-light">
    <div class="container py-4">
        <header class="d-flex align-items-center mb-4">
            <img src="assets/icon-192.png" alt="logo" width="56" height="56" class="me-3">
            <h1 class="h3 mb-0">FajneNotatki</h1>
        </header>
        <section id="auth-view" class="card p-3 mb-3">
            <h2 class="h5">Odblokuj aplikację</h2>
            <p id="auth-msg" class="text-muted">Użyj FaceID / TouchID lub PIN.</p>
            <div class="d-flex gap-2">
                <button id="btn-auth" class="btn btn-primary">Odblokuj biometrią</button>
                <button id="btn-register" class="btn btn-outline-secondary">Zarejestruj się</button>
                <button id="btn-fallback" class="btn btn-link ms-auto">Użyj PIN</button>
            </div>
            <div id="pin-area" class="mt-3 d-none">
                <input id="pin-input" class="form-control mb-2" placeholder="Wprowadź PIN">
                <div class="d-flex gap-2">
                    <button id="btn-pin-login" class="btn btn-success">Zaloguj przez kod PIN</button>
                    <button id="btn-pin-set" class="btn btn-outline-secondary">Ustaw kod PIN</button>
                </div>
            </div>
        </section>
        <section id="app-view" class="d-none">
            <div class="d-flex mb-3">
                <input id="search" class="form-control me-2" placeholder="Szukaj notatek">
                <button id="btn-new" class="btn btn-success">+ Nowa notatka</button>
                <button id="btn-install" class="btn btn-outline-primary ms-2 d-none">Zainstaluj appke</button>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <div id="notes-list" class="list-group"></div>
                </div>
                <div class="col-md-8">
                    <div id="editor" class="card p-3 d-none">
                        <div class="mb-2 d-flex justify-content-between">
                            <input id="note-title" class="form-control me-2" placeholder="Tytuł notatki">
                            <small id="note-meta" class="text-muted align-self-center">—</small>
                        </div>
                        <textarea id="note-body" class="form-control mb-2" rows="10"
                            placeholder="Treść notatki"></textarea>
                        <div class="d-flex gap-2">
                            <button id="btn-save" class="btn btn-primary">Zapisz</button>
                            <button id="btn-delete" class="btn btn-danger">Usuń</button>
                            <button id="btn-ocr" class="btn btn-outline-secondary ms-auto">Skanuj tekst ze
                                zdjęcia</button>
                            <button id="btn-speech" class="btn btn-outline-secondary">Dyktuj tekst</button>
                        </div>
                        <div id="ocr-preview" class="mt-3 small text-muted"></div>
                    </div>
                    <div id="empty" class="card p-4 text-center text-muted">Wybierz lub stwórz notatkę aby zacząć.</div>
                </div>
            </div>
        </section>
    </div>
    <video id="video" autoplay playsinline class="d-none"></video>
    <canvas id="canvas" class="d-none"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/idb@7/build/iife/index-min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
    <script src="js/db.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/ocr.js"></script>
    <script src="js/speech.js"></script>
    <script src="js/app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js').then(() => console.log('SW registered'));
        }
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('btn-install').classList.remove('d-none');
        });
        document.getElementById('btn-install').addEventListener('click', async () => {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            await deferredPrompt.userChoice;
            deferredPrompt = null;
            document.getElementById('btn-install').classList.add('d-none');
        });
    </script>
</body>

</html>